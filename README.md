

Have something like a 'StorageManager'


TODO better handling of join conditions: 
represent as a `Seq[Code[Bool]]` and move down those conditions that do not concern the join




